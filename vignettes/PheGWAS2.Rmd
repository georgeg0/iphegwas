---
title: "Intro to the PheGWAS package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{PheGWAS2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{dplyr}
  %\VignetteDepends{httr}
  %\VignetteDepends{jsonlite}
  %\VignetteDepends{xml2}
  %\VignetteDepends{stringr}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",fig.width=12, fig.height=9, message=FALSE, tidy=TRUE, dpi=75)
```

```{r setup}
library(PheGWAS2)
```
Following processed summary data are from the lipid consortium:

```{r}
head(hdl)
HDL <- hdl
```
```{r}
head(ldl)
LDL <- ldl
```
```{r}
head(trig)
TRIGS <- trig
```
```{r}
head(tchol)
TOTALCHOLESTROL <- tchol
```
The dataframe’s are passed to processphegwas function as a list of dataframe’s.

```{r}
phenos <- c("HDL", "LDL", "TRIGS", "TOTALCHOLESTROL")
y <- fastprocessphegwas(phenos)
```

3D landscape visualization of all the phenotypes across the base pair positions(above a threshold of -log10 (p) 6)
```{r}
landscapefast(y,sliceval = 10,phenos =phenos)
```

3D landscape visualization of chromosome number 19 (above a threshold of -log10 (p) 10)
```{r}
landscapefast(y,sliceval = 7.5,chromosome = 19,phenos =phenos)
```

3D landscape visualization of chromosome number 19, gene view active  (above a threshold of -log10 (p) 10)
```{r}
landscapefast(y,sliceval = 7.5,chromosome = 19, geneview = TRUE,phenos =phenos)
```

3D visualization with LD block (for european population) passing externally, parameter to pass LD and also calculate the mutualLD block
```{r}
landscapefast(y, sliceval = 30, chromosome = 19,calculateLD= TRUE,mutualLD = TRUE,phenos =phenos)
```
